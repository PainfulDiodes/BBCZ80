BEANZEE.asm:
     1                          ; BEANZEE.Z80 - BeanZee Entry Point and Hardware Functions
     2                          ;
     3                          ; Entry point for BBC BASIC Z80 on the BeanZee system.
     4                          ; ROM boot at address 0x0000. Code in ROM (0x0000-0x7FFF),
     5                          ; RAM at 0x8000-0xFFFF.
     6                          ;
     7                          ; Provides screen control and time functions required by
     8                          ; the core interpreter (EXEC.Z80, EVAL.Z80).
     9                          ;
    10                          ; cf. DIST.Z80 (CP/M), ACORN.Z80 (Acorn tube)
    11                          ;
    12                              PUBLIC CLRSCN
    13                              PUBLIC PUTCSR
    14                              PUBLIC GETCSR
    15                              PUBLIC PUTIME
    16                              PUBLIC GETIME
    17                          ;
    18                              EXTERN START        ; MAIN.Z80 interpreter entry
    19                              EXTERN OSWRCH       ; BMOS.Z80 character output
    20                          ;
    21                          ; Entry point - first instruction at 0x0000
    22                          ;
    23  0000  c30000                JP START            ; Jump to BASIC cold start
    24                          ;
    25                          ;CLRSCN - Clear screen.
    26                          ;   Send VT100 escape sequence: ESC[2J ESC[H
    27                          ;   Destroys: A,D,E,H,L,F
    28                          ;
    29                          CLRSCN:
    30  0003  3e1b                  LD A,1BH            ; ESC
    31  0005  cd0000                CALL OSWRCH
    32  0008  3e5b                  LD A,'['
    33  000a  cd0000                CALL OSWRCH
    34  000d  3e32                  LD A,'2'
    35  000f  cd0000                CALL OSWRCH
    36  0012  3e4a                  LD A,'J'
    37  0014  cd0000                CALL OSWRCH
    38  0017  3e1b                  LD A,1BH            ; ESC
    39  0019  cd0000                CALL OSWRCH
    40  001c  3e5b                  LD A,'['
    41  001e  cd0000                CALL OSWRCH
    42  0021  3e48                  LD A,'H'
    43  0023  c30000                JP OSWRCH           ; Cursor home and return
    44                          ;
    45                          ;PUTCSR - Move cursor to specified position.
    46                          ;   Inputs: DE = horizontal position (LHS=0)
    47                          ;           HL = vertical position (TOP=0)
    48                          ;   Destroys: A,D,E,H,L,F
    49                          ;
    50                          PUTCSR:
    51  0026  c9                    RET                 ; Not implemented
    52                          ;
    53                          ;GETCSR - Return cursor coordinates.
    54                          ;   Outputs: DE = X coordinate (POS)
    55                          ;            HL = Y coordinate (VPOS)
    56                          ;   Destroys: A,D,E,H,L,F
    57                          ;
    58                          GETCSR:
    59  0027  110000                LD DE,0
    60  002a  210000                LD HL,0
    61  002d  c9                    RET
    62                          ;
    63                          ;PUTIME - Load elapsed-time clock.
    64                          ;   Inputs: DEHL = time to load (centiseconds)
    65                          ;   Destroys: A,D,E,H,L,F
    66                          ;
    67                          PUTIME:
    68  002e  c9                    RET                 ; No clock hardware
    69                          ;
    70                          ;GETIME - Read elapsed-time clock.
    71                          ;   Outputs: DEHL = elapsed time (centiseconds)
    72                          ;   Destroys: A,D,E,H,L,F
    73                          ;
    74                          GETIME:
    75  002f  110000                LD DE,0
    76  0032  210000                LD HL,0
    77  0035  c9                    RET
    78                          ;
    79                          FIN:
    80                          
